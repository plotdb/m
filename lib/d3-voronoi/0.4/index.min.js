// https://d3js.org/d3-voronoi/ Version 0.4.0. Copyright 2016 Mike Bostock.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.d3=t.d3||{})}(this,function(t){"use strict";function e(t){return function(){return t}}function n(t){return t[0]}function r(t){return t[1]}function i(){this._=null}function f(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function s(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function u(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function l(t){for(;t.L;)t=t.L;return t}function a(t,e,n,r){var i=[null,null],f=F.push(i)-1;return i.left=t,i.right=e,n&&h(i,t,e,n),r&&h(i,e,t,r),B[t.index].halfedges.push(f),B[e.index].halfedges.push(f),i}function o(t,e,n){var r=[e,n];return r.left=t,r}function h(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function c(t,e,n,r,i){var f,s,u=t[0],l=t[1],a=u[0],o=u[1],h=l[0],c=l[1],g=0,d=1,v=h-a,C=c-o;if(s=e-a,v||!(s>0)){if(s/=v,0>v){if(g>s)return;d>s&&(d=s)}else if(v>0){if(s>d)return;s>g&&(g=s)}if(s=r-a,v||!(0>s)){if(s/=v,0>v){if(s>d)return;s>g&&(g=s)}else if(v>0){if(g>s)return;d>s&&(d=s)}if(s=n-o,C||!(s>0)){if(s/=C,0>C){if(g>s)return;d>s&&(d=s)}else if(C>0){if(s>d)return;s>g&&(g=s)}if(s=i-o,C||!(0>s)){if(s/=C,0>C){if(s>d)return;s>g&&(g=s)}else if(C>0){if(g>s)return;d>s&&(d=s)}return g>0||1>d?(f=t.left,s=t.right,g>0&&(u=[a+g*v,o+g*C]),1>d&&(l=[a+d*v,o+d*C]),t=[u,l],t.left=f,t.right=s,t):t}}}}}function g(t,e,n,r,i){var f=t[1];if(f)return t;var s,u,l=t[0],a=t.left,o=t.right,h=a[0],c=a[1],g=o[0],d=o[1],v=(h+g)/2,C=(c+d)/2;if(d===c){if(e>v||v>=r)return;if(h>g){if(l){if(l[1]>=i)return}else l=[v,n];f=[v,i]}else{if(l){if(l[1]<n)return}else l=[v,i];f=[v,n]}}else if(s=(h-g)/(d-c),u=C-s*v,-1>s||s>1)if(h>g){if(l){if(l[1]>=i)return}else l=[(n-u)/s,n];f=[(i-u)/s,i]}else{if(l){if(l[1]<n)return}else l=[(i-u)/s,i];f=[(n-u)/s,n]}else if(d>c){if(l){if(l[0]>=r)return}else l=[e,s*e+u];f=[r,s*r+u]}else{if(l){if(l[0]<e)return}else l=[r,s*r+u];f=[e,s*e+u]}return t=[l,f],t.left=a,t.right=o,t}function d(t,e,n,r){for(var i,f=F.length,s=new Array(f);f--;)(i=g(F[f],t,e,n,r))&&(i=c(i,t,e,n,r))&&(Math.abs(i[0][0]-i[1][0])>I||Math.abs(i[0][1]-i[1][1])>I)&&(s[f]=i);return s}function v(t){return B[t.index]={site:t,halfedges:[]}}function C(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function L(t,e){return e[+(e.left!==t.site)]}function p(t,e){return e[+(e.left===t.site)]}function R(){for(var t,e,n,r,i=0,f=B.length;f>i;++i)if((t=B[i])&&(r=(e=t.halfedges).length)){var s=new Array(r),u=new Array(r);for(n=0;r>n;++n)s[n]=n,u[n]=C(t,F[e[n]]);for(s.sort(function(t,e){return u[e]-u[t]}),n=0;r>n;++n)u[n]=e[s[n]];for(n=0;r>n;++n)e[n]=u[n]}}function y(t,e,n,r,i){for(var f,s,u,l,a,h,c,g,d,v,C=B.length;C--;)if(f=B[C]){for(u=f.halfedges,s=u.length;s--;)t[u[s]]||u.splice(s,1);for(s=0,l=u.length;l>s;)g=p(f,t[u[s]]),d=g[0],v=g[1],a=L(f,t[u[++s%l]]),h=a[0],c=a[1],(Math.abs(d-h)>I||Math.abs(v-c)>I)&&(u.splice(s,0,t.push(o(f.site,g,Math.abs(d-e)<I&&i-v>I?[e,Math.abs(h-e)<I?c:i]:Math.abs(v-i)<I&&r-d>I?[Math.abs(c-i)<I?h:r,i]:Math.abs(d-r)<I&&v-n>I?[r,Math.abs(h-r)<I?c:n]:Math.abs(v-n)<I&&d-e>I?[Math.abs(c-n)<I?h:e,n]:null))-1),++l)}}function b(){f(this),this.x=this.y=this.arc=this.site=this.cy=null}function M(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,f=n.site;if(r!==f){var s=i[0],u=i[1],l=r[0]-s,a=r[1]-u,o=f[0]-s,h=f[1]-u,c=2*(l*h-a*o);if(!(c>=-J)){var g=l*l+a*a,d=o*o+h*h,v=(h*g-a*d)/c,C=(l*d-o*g)/c,L=G.pop()||new b;L.arc=t,L.site=i,L.x=v+s,L.y=(L.cy=C+u)+Math.sqrt(v*v+C*C),t.circle=L;for(var p=null,R=D._;R;)if(L.y<R.y||L.y===R.y&&L.x<=R.x){if(!R.L){p=R.P;break}R=R.L}else{if(!R.R){p=R;break}R=R.R}D.insert(p,L),p||(z=L)}}}}function U(t){var e=t.circle;e&&(e.P||(z=e.N),D.remove(e),G.push(e),f(e),t.circle=null)}function x(){f(this),this.edge=this.site=this.circle=null}function N(t){var e=H.pop()||new x;return e.site=t,e}function P(t){U(t),O.remove(t),H.push(t),f(t)}function _(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],f=t.P,s=t.N,u=[t];P(t);for(var l=f;l.circle&&Math.abs(n-l.circle.x)<I&&Math.abs(r-l.circle.cy)<I;)f=l.P,u.unshift(l),P(l),l=f;u.unshift(l),U(l);for(var o=s;o.circle&&Math.abs(n-o.circle.x)<I&&Math.abs(r-o.circle.cy)<I;)s=o.N,u.push(o),P(o),o=s;u.push(o),U(o);var c,g=u.length;for(c=1;g>c;++c)o=u[c],l=u[c-1],h(o.edge,l.site,o.site,i);l=u[0],o=u[g-1],o.edge=a(l.site,o.site,null,i),M(l),M(o)}function k(t){for(var e,n,r,i,f=t[0],s=t[1],u=O._;u;)if(r=w(u,s)-f,r>I)u=u.L;else{if(i=f-m(u,s),!(i>I)){r>-I?(e=u.P,n=u):i>-I?(e=u,n=u.N):e=n=u;break}if(!u.R){e=u;break}u=u.R}v(t);var l=N(t);if(O.insert(e,l),e||n){if(e===n)return U(e),n=N(e.site),O.insert(l,n),l.edge=n.edge=a(e.site,l.site),M(e),void M(n);if(!n)return void(l.edge=a(e.site,l.site));U(e),U(n);var o=e.site,c=o[0],g=o[1],d=t[0]-c,C=t[1]-g,L=n.site,p=L[0]-c,R=L[1]-g,y=2*(d*R-C*p),b=d*d+C*C,x=p*p+R*R,P=[(R*b-C*x)/y+c,(d*x-p*b)/y+g];h(n.edge,o,L,P),l.edge=a(o,t,null,P),n.edge=a(t,L,null,P),M(e),M(n)}}function w(t,e){var n=t.site,r=n[0],i=n[1],f=i-e;if(!f)return r;var s=t.P;if(!s)return-(1/0);n=s.site;var u=n[0],l=n[1],a=l-e;if(!a)return u;var o=u-r,h=1/f-1/a,c=o/a;return h?(-c+Math.sqrt(c*c-2*h*(o*o/(-2*a)-l+a/2+i-f/2)))/h+r:(r+u)/2}function m(t,e){var n=t.N;if(n)return w(n,e);var r=t.site;return r[1]===e?r[0]:1/0}function E(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function A(t,e){return e[1]-t[1]||e[0]-t[0]}function j(t,e){var n,r,f,s=t.sort(A).pop();for(F=[],B=new Array(t.length),O=new i,D=new i;;)if(f=z,s&&(!f||s[1]<f.y||s[1]===f.y&&s[0]<f.x))s[0]===n&&s[1]===r||(k(s),n=s[0],r=s[1]),s=t.pop();else{if(!f)break;_(f.arc)}if(R(),e){var u=e[0][0],l=e[0][1],a=e[1][0],o=e[1][1];this.extent=[[u,l],[a,o]],this.cellEdges=d(u,l,a,o),y(this.cellEdges,u,l,a,o)}else this.cellEdges=F;this.cells=B,this.edges=F,O=D=F=B=null}function q(){function t(t){return new j(t.map(function(e,n){var r=[Math.round(i(e,n,t)/I)*I,Math.round(f(e,n,t)/I)*I];return r.index=n,r.data=e,r}),s)}var i=n,f=r,s=null;return t.polygons=function(e){return t(e).polygons()},t.links=function(e){return t(e).links()},t.triangles=function(e){return t(e).triangles()},t.x=function(n){return arguments.length?(i="function"==typeof n?n:e(+n),t):i},t.y=function(n){return arguments.length?(f="function"==typeof n?n:e(+n),t):f},t.extent=function(e){return arguments.length?(s=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],t):s&&[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},t.size=function(e){return arguments.length?(s=null==e?null:[[0,0],[+e[0],+e[1]]],t):s&&[s[1][0],s[1][1]]},t}i.prototype={constructor:i,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=l(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(s(this,n),t=n,n=t.U),n.C=!1,r.C=!0,u(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(u(this,n),t=n,n=t.U),n.C=!1,r.C=!0,s(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,f=t.L,a=t.R;if(n=f?a?l(a):f:a,i?i.L===t?i.L=n:i.R=n:this._=n,f&&a?(r=n.C,n.C=t.C,n.L=f,f.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===i.L){if(e=i.R,e.C&&(e.C=!1,i.C=!0,s(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,u(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,s(this,i),t=this._;break}}else if(e=i.L,e.C&&(e.C=!1,i.C=!0,u(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,s(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,u(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var z,O,B,D,F,G=[],H=[],I=1e-6,J=1e-12;j.prototype={constructor:j,polygons:function(){var t=this.cells,e=this.cellEdges,n=this.extent,r=n[0][0],i=n[0][1],f=n[1][0],s=n[1][1],u=new Array(t.length);return t.forEach(function(t,n){var l,a=t.site,o=t.halfedges;if(o.length)l=o.map(function(n){return L(t,e[n])});else{if(!(a[0]>=r&&a[0]<=f&&a[1]>=i&&a[1]<=s))return;l=[[r,s],[f,s],[f,i],[r,i]]}u[n]=l,l.data=a.data}),u},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){for(var i,f=n.site,s=n.halfedges,u=-1,l=s.length,a=e[s[l-1]],o=a.left===f?a.right:a.left;++u<l;)i=o,a=e[s[u]],o=a.left===f?a.right:a.left,r<i.index&&r<o.index&&E(f,i,o)<0&&t.push([f.data,i.data,o.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})}},t.voronoi=q,Object.defineProperty(t,"__esModule",{value:!0})});