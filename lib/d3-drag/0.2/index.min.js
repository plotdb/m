!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-dispatch"),require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],e):e(t.d3_drag=t.d3_drag||{},t.d3_dispatch,t.d3_selection)}(this,function(t,e,n){"use strict";function o(){n.event.stopImmediatePropagation()}function i(){n.event.preventDefault(),n.event.stopImmediatePropagation()}function r(t){var e=t.document.documentElement,o=n.select(t).on("dragstart.drag",i,!0);"onselectstart"in e?o.on("selectstart.drag",i,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function c(t,e){var o=t.document.documentElement,r=n.select(t).on("dragstart.drag",null);e&&(r.on("click.drag",i,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in o?r.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}function u(t){return function(){return t}}function s(t,e,n,o,i,r,c,u,s,a){this.target=t,this.type=e,this.subject=n,this.identifier=o,this.active=i,this.x=r,this.y=c,this.dx=u,this.dy=s,this._=a}function a(){return!n.event.button}function d(){return this.parentNode}function l(t){return null==t?{x:n.event.x,y:n.event.y}:t}function f(){function t(t){t.on("mousedown.drag",f).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",m).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){if(!b&&w.apply(this,arguments)){var t=y("mouse",x.apply(this,arguments),n.mouse,this,arguments);t&&(n.select(n.event.view).on("mousemove.drag",h,!0).on("mouseup.drag",p,!0),r(n.event.view),o(),_=!1,t("start"))}}function h(){i(),_=!0,E.mouse("drag")}function p(){n.select(n.event.view).on("mousemove.drag mouseup.drag",null),c(n.event.view,_),i(),E.mouse("end")}function g(){if(w.apply(this,arguments)){var t,e,i=n.event.changedTouches,r=x.apply(this,arguments),c=i.length;for(t=0;c>t;++t)(e=y(i[t].identifier,r,n.touch,this,arguments))&&(o(),e("start"))}}function v(){var t,e,o=n.event.changedTouches,r=o.length;for(t=0;r>t;++t)(e=E[o[t].identifier])&&(i(),e("drag"))}function m(){var t,e,i=n.event.changedTouches,r=i.length;for(b&&clearTimeout(b),b=setTimeout(function(){b=null},500),t=0;r>t;++t)(e=E[i[t].identifier])&&(o(),e("end"))}function y(e,o,i,r,c){var u,a,d,l=i(o,e),f=j.copy();if(n.customEvent(new s(t,"beforestart",u,e,k,l[0],l[1],0,0,f),function(){return null==(n.event.subject=u=T.apply(r,c))?!1:(a=u.x-l[0]||0,d=u.y-l[1]||0,!0)}))return function h(p){var g,v=l;switch(p){case"start":E[e]=h,g=k++;break;case"end":delete E[e],--k;case"drag":l=i(o,e),g=k}n.customEvent(new s(t,p,u,e,g,l[0]+a,l[1]+d,l[0]-v[0],l[1]-v[1],f),f.apply,f,[p,r,c])}}var _,b,w=a,x=d,T=l,E={},j=e.dispatch("start","drag","end"),k=0;return t.filter=function(e){return arguments.length?(w="function"==typeof e?e:u(!!e),t):w},t.container=function(e){return arguments.length?(x="function"==typeof e?e:u(e),t):x},t.subject=function(e){return arguments.length?(T="function"==typeof e?e:u(e),t):T},t.on=function(){var e=j.on.apply(j,arguments);return e===j?t:e},t}var h="0.2.2";s.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t},t.version=h,t.drag=f,t.dragDisable=r,t.dragEnable=c});