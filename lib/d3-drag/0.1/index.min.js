!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-dispatch"),require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],e):e(t.d3_drag=t.d3_drag||{},t.d3_dispatch,t.d3_selection)}(this,function(t,e,n){"use strict";function o(){n.event.stopImmediatePropagation()}function r(){n.event.preventDefault(),n.event.stopImmediatePropagation()}function i(t){var e=t.document.documentElement,o=n.select(t).on("dragstart.drag",r,!0);"onselectstart"in e?o.on("selectstart.drag",r,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function u(t,e){var o=t.document.documentElement,i=n.select(t).on("dragstart.drag",null);e&&(i.on("click.drag",r,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in o?i.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}function c(t){return function(){return t}}function s(t,e,n,o,r,i,u,c,s){this.type=t,this.subject=e,this.identifier=n,this.active=o,this.x=r,this.y=i,this.dx=u,this.dy=c,this._=s}function a(){return!n.event.button}function d(){return this.parentNode}function l(t){return null==t?{x:n.event.x,y:n.event.y}:t}function f(){return n.event.subject.x}function h(){return n.event.subject.y}function p(t){function p(t){t.on("mousedown.drag",g).on("touchstart.drag",m).on("touchmove.drag",_).on("touchend.drag touchcancel.drag",b).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(){if(!j&&T.apply(this,arguments)){var t=w("mouse",E.apply(this,arguments),n.mouse,this,arguments);t&&(n.select(n.event.view).on("mousemove.drag",v,!0).on("mouseup.drag",y,!0),i(n.event.view),o(),x=!1,t("start"))}}function v(){r(),x=!0,S.mouse("drag")}function y(){n.select(n.event.view).on("mousemove.drag mouseup.drag",null),u(n.event.view,x),r(),S.mouse("end")}function m(){if(T.apply(this,arguments)){var t,e,r=n.event.changedTouches,i=E.apply(this,arguments),u=r.length;for(o(),t=0;u>t;++t)(e=w(r[t].identifier,i,n.touch,this,arguments))&&e("start")}}function _(){var t,e,o=n.event.changedTouches,i=o.length;for(r(),t=0;i>t;++t)(e=S[o[t].identifier])&&e("drag")}function b(){var t,e,r=n.event.changedTouches,i=r.length;for(o(),j&&clearTimeout(j),j=setTimeout(function(){j=null},500),t=0;i>t;++t)(e=S[r[t].identifier])&&e("end")}function w(t,e,o,r,i){var u,c,a,d=o(e,t),l=U.copy();if(n.customEvent(new s("beforestart",a,t,q,d[0],d[1],0,0,l),function(){return null==(n.event.subject=a=k.apply(r,i))?!1:(u=z.apply(r,i)-d[0]||0,c=M.apply(r,i)-d[1]||0,!0)}))return function f(h){var p,g=d;switch(h){case"start":S[t]=f,p=q++;break;case"end":delete S[t],--q;case"drag":d=o(e,t),p=q}n.customEvent(new s(h,a,t,p,d[0]+u,d[1]+c,d[0]-g[0],d[1]-g[1],l),l.apply,l,[h,r,i])}}var x,j,T=a,E=d,k=l,z=f,M=h,S={},U=e.dispatch("start","drag","end").on("start",t),q=0;return p.filter=function(t){return arguments.length?(T="function"==typeof t?t:c(!!t),p):T},p.container=function(t){return arguments.length?(E="function"==typeof t?t:c(t),p):E},p.subject=function(t){return arguments.length?(k="function"==typeof t?t:c(t),p):k},p.x=function(t){return arguments.length?(z="function"==typeof t?t:c(+t),p):z},p.y=function(t){return arguments.length?(M="function"==typeof t?t:c(+t),p):M},p.on=function(){var t=U.on.apply(U,arguments);return t===U?p:t},p}var g="0.1.5";s.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t},t.version=g,t.drag=p,t.dragDisable=i,t.dragEnable=u});