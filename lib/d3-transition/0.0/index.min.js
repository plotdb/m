!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-selection"),require("d3-ease"),require("d3-timer"),require("d3-interpolate"),require("d3-dispatch")):"function"==typeof define&&define.amd?define(["exports","d3-selection","d3-ease","d3-timer","d3-interpolate","d3-dispatch"],e):e(t.d3_transition={},t.d3_selection,t.d3_ease,t.d3_timer,t.d3_interpolate,t.d3_dispatch)}(this,function(t,e,n,r,i,o){"use strict";function a(t,n){return"transform"===n&&t.namespaceURI===e.namespaces.svg?i.interpolateTransform:i.interpolate}function u(t){return function(){this.removeAttribute(t)}}function s(t){return function(){this.removeAttributeNS(t.space,t.local)}}function l(t,e){var n,r;return e+="",function(){var i=this.getAttribute(t);return i===e?null:i===n?r:r=a(this,t)(n=i,e)}}function c(t,e){var n,r;return e+="",function(){var o=this.getAttributeNS(t.space,t.local);return o===e?null:o===n?r:r=i.interpolate(n=o,e)}}function h(t,e){var n,r,i;return function(){var o,u=e.apply(this,arguments);return null==u?void this.removeAttribute(t):(o=this.getAttribute(t),u+="",o===u?null:o===n&&u===r?i:i=a(this,t)(n=o,r=u))}}function f(t,e){var n,r,o;return function(){var a,u=e.apply(this,arguments);return null==u?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),u+="",a===u?null:a===n&&u===r?o:o=i.interpolate(n=a,r=u))}}function p(t,n){var r=e.namespace(t);return this.attrTween(t,(null==n?r.local?s:u:"function"==typeof n?r.local?f:h:r.local?c:l)(r,n))}function d(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}function _(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n}function v(t,n){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;var i=e.namespace(t);return this.tween(r,(i.local?d:_)(i,n))}function y(t,e,n,r,i,o){var a=t[e];if(a){if(g(t,e,n))return}else t[e]=a={active:null,pending:[]};b(t,e,{id:n,index:r,group:i,on:rt,tweens:it,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ot})}function g(t,e,n){var r=t[e];if(r){var i=r.active;if(i&&i.id===n)return i;for(var o=r.pending,a=o.length;--a>=0;)if((i=o[a]).id===n)return i}}function m(t,e,n){var r=g(t,e,n);if(!r||r.state>ot)throw new Error("too late");return r}function w(t,e,n){var r=g(t,e,n);if(!r||r.state>at)throw new Error("too late");return r}function A(t,e,n){var r=g(t,e,n);if(!r)throw new Error("too late");return r}function b(t,e,n){function i(t){n.state=at,n.delay<=t?o(t-n.delay):n.timer.restart(o,n.delay,n.time)}function o(e){var i,o,l,c,h=s.active,f=s.pending;for(h&&(h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group)),i=0,o=-1,l=f.length;l>i;++i)c=f[i],c.id<n.id?c.timer.stop():c.id>n.id&&(f[++o]=c);for(f.length=o+1,s.active=n,r.timerOnce(function(){s.active===n&&(n.timer.restart(a,n.delay,n.time),a(e))}),n.on.call("start",t,t.__data__,n.index,n.group),n.state=ut,u=new Array(l=n.tweens.length),i=0,o=-1;l>i;++i)(c=n.tweens[i].value.call(t,t.__data__,n.index,n.group))&&(u[++o]=c);u.length=o+1}function a(r){var i,o,a=r/n.duration,l=a>=1?1:n.ease.call(null,a);for(i=0,o=u.length;o>i;++i)u[i].call(null,l);a>=1&&(n.on.call("end",t,t.__data__,n.index,n.group),s.active=null,s.pending.length||delete t[e],n.timer.stop())}var u,s=t[e];s.pending.push(n),n.timer=r.timer(i,0,n.time)}function x(t,e,n){return function(){m(this,t,e).delay=+n.apply(this,arguments)}}function k(t,e,n){return n=+n,function(){m(this,t,e).delay=n}}function P(t){var e=this._key,n=this._id;return arguments.length?this.each(("function"==typeof t?x:k)(e,n,t)):A(this.node(),e,n).delay}function S(t,e,n){return function(){w(this,t,e).duration=+n.apply(this,arguments)}}function C(t,e,n){return n=+n,function(){w(this,t,e).duration=n}}function N(t){var e=this._key,n=this._id;return arguments.length?this.each(("function"==typeof t?S:C)(e,n,t)):A(this.node(),e,n).duration}function T(t,e,n){return function(){w(this,t,e).ease=n}}function q(t){var e=this._key,n=this._id;return arguments.length?this.each(T(e,n,t)):A(this.node(),e,n).ease}function V(t){"function"!=typeof t&&(t=e.matcher(t));for(var n=this._groups,r=n.length,i=new Array(r),o=0;r>o;++o)for(var a,u=n[o],s=u.length,l=i[o]=[],c=0;s>c;++c)(a=u[c])&&t.call(a,a.__data__,c,u)&&l.push(a);return new Y(i,this._parents,this._key,this._id)}function E(t,e,n,r){var i,o;return function(){var a=m(this,t,e),u=a.on;u!==i&&(o=(i=u).copy()).on(n,r),a.on=o}}function z(t,e){var n=this._key,r=this._id;return arguments.length<2?A(this.node(),n,r).on.on(t):this.each(E(n,r,t,e))}function I(t){return function(){var e=this.parentNode;e&&!this[t]&&e.removeChild(this)}}function O(){return this.on("end.remove",I(this._key))}function j(t){var n=this._key,r=this._id;"function"!=typeof t&&(t=e.selector(t));for(var i=this._groups,o=i.length,a=new Array(o),u=0;o>u;++u)for(var s,l,c=i[u],h=c.length,f=a[u]=new Array(h),p=0;h>p;++p)(s=c[p])&&(l=t.call(s,s.__data__,p,c))&&("__data__"in s&&(l.__data__=s.__data__),f[p]=l,y(f[p],n,r,p,f,A(s,n,r)));return new Y(a,this._parents,n,r)}function R(t){var n=this._key,r=this._id;"function"!=typeof t&&(t=e.selectorAll(t));for(var i=this._groups,o=i.length,a=[],u=[],s=0;o>s;++s)for(var l,c=i[s],h=c.length,f=0;h>f;++f)if(l=c[f]){for(var p,d=t.call(l,l.__data__,f,c),_=A(l,n,r),v=0,g=d.length;g>v;++v)(p=d[v])&&y(p,n,r,v,d,_);a.push(d),u.push(l)}return new Y(i,u,n,r)}function U(t){var n,r,o;return function(){var a=e.window(this).getComputedStyle(this,null),u=a.getPropertyValue(t),s=(this.style.removeProperty(t),a.getPropertyValue(t));return u===s?null:u===n&&s===r?o:o=i.interpolate(n=u,r=s)}}function B(t){return function(){this.style.removeProperty(t)}}function D(t,n){var r,o;return n+="",function(){var a=e.window(this).getComputedStyle(this,null).getPropertyValue(t);return a===n?null:a===r?o:o=i.interpolate(r=a,n)}}function F(t,n){var r,o,a;return function(){var u=e.window(this).getComputedStyle(this,null),s=u.getPropertyValue(t),l=n.apply(this,arguments);return null==l?(this.style.removeProperty(t),l=u.getPropertyValue(t)):l+="",s===l?null:s===r&&l===o?a:a=i.interpolate(r=s,o=l)}}function G(t,e,n){return null==e?this.styleTween(t,U(t)).on("end.style."+t,B(t)):this.styleTween(t,("function"==typeof e?F:D)(t,e),n)}function H(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}function J(t,e,n){var r="style."+t;return arguments.length<2?(r=this.tween(r))&&r._value:this.tween(r,H(t,e,null==n?"":n))}function K(t){return t=null==t?"":t+"",function(){this.textContent=t}}function L(t){return function(){var e=t.apply(this,arguments);null==e&&(e=""),this.textContent=e}}function M(t){return this.tween("text",("function"==typeof t?L:K)(t))}function Q(){for(var t=this._key,e=this._id,n=$(),r=this._groups,i=r.length,o=0;i>o;++o)for(var a,u=r[o],s=u.length,l=0;s>l;++l)if(a=u[l]){var c=A(a,t,e);y(a,t,n,l,u,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Y(r,this._parents,t,n)}function W(t,e,n,r){var i,o;return function(){var a=w(this,t,e),u=a.tweens;if(u!==i){o=(i=u).slice();for(var s={name:n,value:r},l=0,c=o.length;c>l;++l)if(o[l].name===n){o[l]=s;break}l===c&&o.push(s)}a.tweens=o}}function X(t,e){var n=this._key,r=this._id;if(t+="",arguments.length<2){for(var i,o=A(this.node(),n,r).tweens,a=0,u=o.length;u>a;++a)if((i=o[a]).name===t)return i.value;return null}return this.each(W(n,r,t,e))}function Y(t,e,n,r){this._groups=t,this._parents=e,this._key=n,this._id=r}function Z(t){return e.selection().transition(t)}function $(){return++st}function tt(t){return t?"__transition_"+t+"__":"__transition__"}function et(t){var e=tt(t);return this.each(function(){var t=this[e];if(t){var n,r,i=t.pending,o=t.active;for(o&&(o.on.call("interrupt",this,this.__data__,o.index,o.group),t.active=null,o.timer.stop()),n=0,r=i.length;r>n;++n)i[n].timer.stop();i.length=0,delete this[e]}})}function nt(t){for(var e=$(),i=tt(t),o={time:r.now(),delay:0,duration:250,ease:n.easeCubicInOut},a=this._groups,u=a.length,s=new Array(u),l=0;u>l;++l)for(var c,h=a[l],f=h.length,p=s[l]=new Array(f),d=0;f>d;++d)(c=h[d])&&y(p[d]=c,i,e,d,p,o);return new Y(s,this._parents,i,e)}var rt=o.dispatch("start","end","interrupt"),it=[],ot=0,at=1,ut=2,st=0,lt=e.selection.prototype;Y.prototype=Z.prototype={select:j,selectAll:R,filter:V,transition:Q,call:lt.call,nodes:lt.nodes,node:lt.node,size:lt.size,empty:lt.empty,each:lt.each,on:z,attr:p,attrTween:v,style:G,styleTween:J,text:M,remove:O,tween:X,delay:P,duration:N,ease:q},e.selection.prototype.interrupt=et,e.selection.prototype.transition=nt;var ct="0.0.9";t.version=ct,t.transition=Z});