!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.d3_quadtree=t.d3_quadtree||{})}(this,function(t){"use strict";function e(t,e){if(!isNaN(t=+t)&&!isNaN(e=+e)){var i,r,n,s,o,h,u,_,f,x=this.cover(t,e)._root,y=this._x0,a=this._y0,p=this._x1,c=this._y1;if(!x)return this._root={x:t,y:e};for(;x.length;)if((h=t>=(r=(y+p)/2))?y=r:p=r,(u=e>=(n=(a+c)/2))?a=n:c=n,i=x,!(x=x[_=u<<1|h]))return i[_]={x:t,y:e};if(s=x.x,o=x.y,t===s&&e===o)return x={x:t,y:e,next:x},i?i[_]=x:this._root=x;do i=i?i[_]=new Array(4):this._root=new Array(4),(h=t>=(r=(y+p)/2))?y=r:p=r,(u=e>=(n=(a+c)/2))?a=n:c=n;while((_=u<<1|h)===(f=(o>=n)<<1|s>=r));return i[f]=x,i[_]={x:t,y:e}}}function i(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var i,r,n=this._root,s=this._x0,o=this._y0,h=this._x1,u=this._y1,_=h-s;if(isNaN(s))s=h=t,o=u=e;else if(s>t||t>h||o>e||e>u)if(_){switch(r=((o+u)/2>e)<<1|(s+h)/2>t){case 0:do i=new Array(4),i[r]=n,n=i;while(_*=2,h=s+_,u=o+_,t>h||e>u);break;case 1:do i=new Array(4),i[r]=n,n=i;while(_*=2,s=h-_,u=o+_,s>t||e>u);break;case 2:do i=new Array(4),i[r]=n,n=i;while(_*=2,h=s+_,o=u-_,t>h||o>e);break;case 3:do i=new Array(4),i[r]=n,n=i;while(_*=2,s=h-_,o=u-_,s>t||o>e)}this._root&&this._root.length&&(this._root=n)}else{o>e?o=e:u=e,s>t?s=t:h=t;var f=h-s,x=u-o;x>f?h=(s-=(x-f)/2)+x:u=(o-=(f-x)/2)+f}return this._x0=s,this._y0=o,this._x1=h,this._y1=u,this}function r(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function n(t,e,i,r,n){this.node=t,this.x0=e,this.y0=i,this.x1=r,this.y1=n}function s(t,e){var i,r,s,o,h,u,_,f=1/0,x=this._x0,y=this._y0,a=this._x1,p=this._y1,c=[],w=this._root;for(w&&c.push(new n(w,x,y,a,p));u=c.pop();)if(!(!(w=u.node)||(r=u.x0)>a||(s=u.y0)>p||(o=u.x1)<x||(h=u.y1)<y))if(w.length){var d=(r+o)/2,l=(s+h)/2;c.push(new n(w[3],d,l,o,h),new n(w[2],r,l,d,h),new n(w[1],d,s,o,l),new n(w[0],r,s,d,l)),(_=(e>=l)<<1|t>=d)&&(u=c[c.length-1],c[c.length-1]=c[c.length-1-_],c[c.length-1-_]=u)}else{var v=t-w.x,g=e-w.y,N=v*v+g*g;if(f>N){var A=Math.sqrt(f=N);x=t-A,y=e-A,a=t+A,p=e+A,i=w}}return i}function o(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e);while(e=e.next)}),t}function h(t){var e,i,r,n,s,o,h,u,_,f,x=this._root,y=+t.x,a=+t.y,p=this._x0,c=this._y0,w=this._x1,d=this._y1;if(!x)return!1;if(x.length)for(;;){if((h=y>=(s=(p+w)/2))?p=s:w=s,(u=a>=(o=(c+d)/2))?c=o:d=o,e=x,!(x=x[_=u<<1|h]))return!1;if(!x.length)break;(e[_+1&3]||e[_+2&3]||e[_+3&3])&&(i=e,f=_)}for(;x!==t;)if(r=x,!(x=x.next))return!1;return(n=x.next)&&delete x.next,r?(n?r.next=n:delete r.next,!0):e?(n?e[_]=n:delete e[_],(x=e[0]||e[1]||e[2]||e[3])&&x===(e[3]||e[2]||e[1]||e[0])&&!x.length&&(i?i[f]=x:this._root=x),!0):(this._root=n,!0)}function u(){return this._root}function _(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function f(t){var e,i,r,s,o,h,u=[],_=this._root;for(_&&u.push(new n(_,this._x0,this._y0,this._x1,this._y1));e=u.pop();)if(!t(_=e.node,r=e.x0,s=e.y0,o=e.x1,h=e.y1)&&_.length){var f=(r+o)/2,x=(s+h)/2;(i=_[3])&&u.push(new n(i,f,x,o,h)),(i=_[2])&&u.push(new n(i,r,x,f,h)),(i=_[1])&&u.push(new n(i,f,s,o,x)),(i=_[0])&&u.push(new n(i,r,s,f,x))}return this}function x(t){var e,i=[],r=[];for(this._root&&i.push(new n(this._root,this._x0,this._y0,this._x1,this._y1));e=i.pop();){var s=e.node;if(s.length){var o,h=e.x0,u=e.y0,_=e.x1,f=e.y1,x=(h+_)/2,y=(u+f)/2;(o=s[0])&&i.push(new n(o,h,u,x,y)),(o=s[1])&&i.push(new n(o,x,u,_,y)),(o=s[2])&&i.push(new n(o,h,y,x,f)),(o=s[3])&&i.push(new n(o,x,y,_,f))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this}function y(){return new a}function a(t,e,i,r){this._x0=+t,this._y0=+e,this._x1=+i,this._y1=+r,this._root=void 0}function p(t){for(var e={x:t.x,y:t.y},i=e;t=t.next;)i=i.next={x:t.x,y:t.y};return e}var c="0.6.0",w=y.prototype=a.prototype;w.copy=function(){var t,e,i=new a(this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return i;if(!r.length)return i._root=p(r),i;for(t=[{source:r,target:i._root=new Array(4)}];r=t.pop();)for(var n=0;4>n;++n)(e=r.source[n])&&(e.length?t.push({source:e,target:r.target[n]=new Array(4)}):r.target[n]=p(e));return i},w.add=e,w.cover=i,w.extent=r,w.find=s,w.points=o,w.remove=h,w.root=u,w.size=_,w.visit=f,w.visitAfter=x,t.version=c,t.quadtree=y});